# Implementation Plan: Revert to Simple DOM Extraction

## 1. Context & Goal
We are reverting the complexity (Network Interceptors, JSON parsing) to rely on the proven **DOM Extraction** method used in the working Vienna version.
We will fix the specific bug that caused Alekhine to fail: the "Analyze" button selector will now handle extra URL parameters (like `isBoardFlipped`).

## 2. Memory Update
Removing `interceptor.js` and JSON parsing logic. Simplifying `src/content/extractor.ts` to strictly poll for the "Analyze" button using a flexible URL check.

## 3. Step-by-Step Instructions

### Step 1: Simplify Extractor Script (The Fix)
**Action:** Modify `src/content/extractor.ts`
**Description:**
- **Remove:** `extractFromNextData`, `findKeys`, `processInterceptedData`.
- **Remove:** The `window.addEventListener` for the interceptor.
- **Update `extractMoves`:**
    - Call `waitForAnalyzeButton` immediately.
    - If found -> Parse URL -> Send `STUDY_EXTRACTED`.
    - If not found -> Send Empty (Error).
- **Update `waitForAnalyzeButton`:**
    - Use the **Flexible Selector**:
      `link.href.includes('/analyze') && link.href.includes('lines=')`
    - Keep the 15s timeout to be safe.

### Step 2: Remove Interceptor
**Action:** Delete `src/content/interceptor.js`.
**Action:** Modify `src/manifest.json`.
**Description:**
- Remove the `src/content/interceptor.js` entry from `content_scripts`.
- Remove `web_accessible_resources`.

### Step 3: Verify No Blocking
**Action:** Modify `src/background/index.ts`
**Description:**
- Ensure `enableWorkerTabBlocking` is definitely commented out or removed.
- Ensure the "Force Clear Rules" block is still there on startup (to clean up any mess from previous attempts).

## 4. Verification
1.  Run `npm run build`.
2.  Reload Extension.
3.  **Test:** Run extraction on "Alekhine's Defense".
4.  **Expectation:** Worker tab opens -> Page loads -> Script finds the button (ignoring the flipped param) -> Lines appear in Dashboard.
